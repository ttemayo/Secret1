<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mystery</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Fixed top nav -->
  <nav class="topnav">
    <div class="nav-inner">
      <a class="logo" href="#scenario">Murder Mystery</a>
      <div class="links">
        <a href="#scenario">Scenario</a>
        <a href="#detective">The Detective</a>
        <a href="#attendees">Attendees</a>
      </div>
    </div>
  </nav>

  <main class="content">

    <!-- Setting image: same max width as the scenario box -->
    <div class="hero-wrapper" aria-hidden="false">
      <img class="setting-image" src="images/murderhouse.png" alt="Naghmi Manor exterior — the setting">
    </div>

    <!-- Scenario section (top text block) -->
    <section id="scenario" class="section">
      <h1>Scenario</h1>

      <!-- scenario card -->
      <div class="scenario-card" role="region" aria-labelledby="scenario-heading" tabindex="0">
        <p class="scenario-lead">
          It's a beautiful winter evening at Naghmi Manor. Zain has stumbled onto newfound wealth and decides to give back to the community in the form of a lavish smashfest. All is well until a scream is heard...
        </p>

        <!-- optional extra text -->
        <p class="scenario-more" aria-hidden="true">
          There's only one person to call.
        </p>

        <button type="button" class="scenario-toggle" aria-expanded="false">Read more</button>
      </div>
    </section>

    <!-- The Detective (centered single thumbnail) -->
    <section id="detective" class="section detective-section" aria-label="The Detective">
      <h2>The Detective</h2>

      <div class="detective-wrapper">
        <figure class="thumb-item detective-item">
          <button class="thumb"
                  data-full="images/cropped_detective.png"
                  data-name="Detective Hungrybox — Investigator"
                  data-bio="<strong>Juan DeBiedma</strong><br/>Veteran investigator, called in to consult.<br/>
                  Sharp eyes and sharper reads, the kind that stay calm when<br/> 
                  the room gets quiet and everything’s on the line. On the streets <br/>
                  they call him Hungrybox... or Clutchbox if you’ve seen the tapes. <br/>
                  The guy who lets the case come down to the last moment, then <br/>
                  finds the one opening that ends it.<br/>"
                  aria-label="Open profile for Detective Rowan">
            <img src="images/small_detective.png" alt="Detective thumbnail" width="300" height="300">
          </button>
          <figcaption>Hungrybox</figcaption>
        </figure>
      </div>
    </section>

    <!-- Attendees (thumbnail grid) -->
    <section id="attendees" class="section">
      <h2>Attendees</h2>

      <!-- thumb grid: 4 columns -->
      <div class="thumb-grid" aria-label="Attendee thumbnails">

        <!-- Zain -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_zain.png"
                  data-name="Zain — Host"
                  data-bio="<strong>Zain Naghmi</strong><br/>Your GOAT.<br/>What he lacks in general awareness, he makes up for in game sense<br/>
                  Surrounded by people who take care of all his needs.<br/>"
                  aria-label="Open profile for Zain">
            <img src="images/small_zain.png" alt="Zain thumbnail" width="300" height="300">
          </button>
          <figcaption>Zain</figcaption>
        </figure>

        <!-- Hena -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_hena.png"
                  data-name="Hena — Sister"
                  data-bio="<strong>Hena Naghmi</strong><br/>The sister/manager/PR/house manager/// ✓.<br/>
                  Manages Zain's image and smooths every wrinkle before anyone even notices.<br/> 
                  Knows what’s best for Zain, even when his problematic feelings get in the way."
                  aria-label="Open profile for Hena">
            <img src="images/small_hena.png" alt="Hena thumbnail" width="300" height="300">
          </button>
          <figcaption>Hena</figcaption>
        </figure>

        <!-- Kevin -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_kevin.png"
                  data-name="Kevin — Butler"
                  data-bio="<strong>Kevin</strong><br/>The mainsion's invisible backbone: schedules, logistics, and order.<br/>
                  Quietly loyal, unfailingly precise, always a few steps ahead<br/>
                  Does what's best for Zain by treating his wishes as truth and truth as obligation."
                  aria-label="Open profile for Kevin">
            <img src="images/small_kevin.png" alt="Kevin thumbnail" width="300" height="300">
          </button>
          <figcaption>Kevin</figcaption>
        </figure>

        <!-- Wolfgang -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_mario.png"
                  data-name="Wolfgang Storm — Controller Modder"
                  data-bio="<strong>Mario</strong><br/>Custom controller modder trusted by top players.<br/>
                  Loud, blunt, and a bit chaotic.<br/>
                  Always feels owed.<br/>"
                  aria-label="Open profile for Wolfgang">
            <img src="images/small_mario.png" alt="Wolfgang thumbnail" width="300" height="300">
          </button>
          <figcaption>Wolfgang Storm</figcaption>
        </figure>

        <!-- Eric -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_eric.png"
                  data-name="Strawberry Milkman — Rival"
                  data-bio="<strong>Eric</strong><br/>The former partner turned rival from Southern Virginia.<br/>
                  Carries the weight of a region on his shoulders, alongside multiple chips.<br/>
                  Persistent sense of being overlooked and under recognized."
                  aria-label="Open profile for Eric">
            <img src="images/small_eric.png" alt="Eric thumbnail" width="300" height="300">
          </button>
          <figcaption>Strawberry Milkman</figcaption>
        </figure>

        <!-- Darren -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_darren.png"
                  data-name="Softserv — Doubles Partner"
                  data-bio="<strong>Darren</strong><br/>Quiet, steady, and rarely in the spotlight.<br/>
                  Observant, self-contained, emotionally guarded.<br/>
                  Notices everything, says little."
                  aria-label="Open profile for Darren">
            <img src="images/small_darren.png" alt="Darren thumbnail" width="300" height="300">
          </button>
          <figcaption>Softserv</figcaption>
        </figure>

        <!-- Aarij -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_aarij.png"
                  data-name="Ludoo — Streamer"
                  data-bio="<strong>Ludoo</strong><br/>Polished, charming, and effortlessly confident on camera.<br/>
                  Obsessed with reach, momentum, and traditional metrics of success.<br/>
                  Sees content as a chessboard, not a game."
                  aria-label="Open profile for Ludoo">
            <img src="images/small_aarij.png" alt="Ludoo thumbnail" width="300" height="300">
          </button>
          <figcaption>Ludoo</figcaption>
        </figure>

        <!-- Adil -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_adil.png"
                  data-name="Gstubs — Twitch Chatter"
                  data-bio="<strong>Gstubs</strong><br/>A parasocial superfan, fueled entirely by Zain's content.<br/>
                  Blurs the line between admiration and obsession.<br/>
                  Would do anything for Zain... probably."
                  aria-label="Open profile for Gstubs">
            <img src="images/small_adil.png" alt="Gstub thumbnail" width="300" height="300">
          </button>
          <figcaption>Gstubs</figcaption>
        </figure>

        <!-- David -->
        <figure class="thumb-item">
          <button class="thumb"
                  data-full="images/cropped_david.png"
                  data-name="David — Tuber"
                  data-bio="<strong>David</strong><br/>Slightly out of place, deeply sincere.<br/>
                  Passionate about niche interests no one asked about.<br/>
                  Observant, and unintentionally insightful"
                  aria-label="Open profile for David">
            <img src="images/small_david.png" alt="David thumbnail" width="300" height="300">
          </button>
          <figcaption>David</figcaption>
        </figure>

      </div>
    </section>
  </main>

  <footer class="site-footer">
    © Kevin Hoang
  </footer>

  <!-- CHARACTER CARD MODAL -->
  <div id="cardModal" class="card-modal" aria-hidden="true" role="dialog" aria-label="Character card">
    <div class="card-backdrop" data-action="close"></div>

    <!-- note: added id and tabindex so script can reset and focus the panel -->
    <div id="cardPanel" class="card-panel" role="document" tabindex="-1">
      <button class="card-close" aria-label="Close character card" data-action="close">&times;</button>

      <div class="card-inner">
        <div class="card-image-wrap">
          <img id="cardImage" src="" alt="Full character image">
        </div>

        <div class="card-text">
          <h3 id="cardName">Character Name</h3>
          <!-- card-bio will be replaced per character -->
          <div id="cardBio" class="card-bio" aria-live="polite"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
  // scenario toggle logic 
  document.addEventListener('DOMContentLoaded', () => {
    const card = document.querySelector('.scenario-card');
    if (!card) return;

    const btn = card.querySelector('.scenario-toggle');
    const more = card.querySelector('.scenario-more');

    if (!btn || !more) return;

    more.style.maxHeight = '0px';
    more.setAttribute('aria-hidden', 'true');

    function setExpanded(expanded) {
      btn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
      if (expanded) {
        more.style.maxHeight = `${more.scrollHeight}px`;
        more.setAttribute('aria-hidden', 'false');
        card.classList.add('expanded');
      } else {
        more.style.maxHeight = '0px';
        more.setAttribute('aria-hidden', 'true');
        card.classList.remove('expanded');
      }
    }

    btn.addEventListener('click', () => {
      const isExpanded = btn.getAttribute('aria-expanded') === 'true';
      setExpanded(!isExpanded);
    });

    card.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        btn.click();
      }
    });

    more.addEventListener('transitionend', (ev) => {
      if (ev.propertyName === 'max-height' && btn.getAttribute('aria-expanded') === 'true') {
        more.style.maxHeight = 'none';
      }
    });
  });

  // Thumbnail -> modal logic (reset scroll, trap focus while open, and ensure close is reachable)
  (function () {
    const modal = document.getElementById('cardModal');
    const modalBackdrop = modal.querySelector('.card-backdrop');
    const modalCloseButtons = modal.querySelectorAll('[data-action="close"]');
    const cardImage = document.getElementById('cardImage');
    const cardName = document.getElementById('cardName');
    const cardBio = document.getElementById('cardBio');
    const modalPanel = document.getElementById('cardPanel');

    function openCard(fullSrc, name, bioHtml, thumbBtn) {
      // set content (leave user-provided text alone)
      cardImage.src = fullSrc;
      cardImage.alt = name;
      cardName.textContent = name;
      cardBio.innerHTML = bioHtml || '<p>No details provided.</p>';

      // show modal
      modal.setAttribute('aria-hidden', 'false');

      // lock body scroll but allow panel scrolling
      document.body.style.overflow = 'hidden';

      // reset panel scroll so viewer starts at top
      if (modalPanel) modalPanel.scrollTop = 0;
      if (cardBio) cardBio.scrollTop = 0;

      // focus close button for keyboard users
      const closeBtn = modal.querySelector('.card-close');
      if (closeBtn) closeBtn.focus();

      // remember origin for focus restore
      modal._lastFocus = thumbBtn || document.activeElement;
    }

    function closeCard() {
      modal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
      cardImage.src = '';
      cardBio.innerHTML = '';
      // restore focus to originating element
      if (modal._lastFocus) modal._lastFocus.focus();
    }

    // attach handlers to thumbnails
    document.querySelectorAll('.thumb').forEach(btn => {
      btn.addEventListener('click', () => {
        const full = btn.getAttribute('data-full');
        const name = btn.getAttribute('data-name') || 'Character';
        const bio = btn.getAttribute('data-bio') || '';
        openCard(full, name, bio, btn);
      });

      btn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          btn.click();
        }
      });
    });

    // close interactions
    modalBackdrop.addEventListener('click', closeCard);
    modalCloseButtons.forEach(b => b.addEventListener('click', closeCard));
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') closeCard();
    });

    // simple focus trap: send focus back to close button if focus leaves modal while open
    document.addEventListener('focus', (ev) => {
      if (modal.getAttribute('aria-hidden') === 'false' && !modal.contains(ev.target)) {
        ev.stopPropagation();
        const closeBtn = modal.querySelector('.card-close');
        if (closeBtn) closeBtn.focus();
      }
    }, true);

  })();
  </script>

</body>
</html>
