<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mystery</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Fixed top nav -->
  <nav class="topnav">
    <div class="nav-inner">
      <a class="logo" href="#scenario">Murder Mystery</a>
      <div class="links">
        <a href="#scenario">Scenario</a>
        <a href="#attendees">Attendees</a>
      </div>
    </div>
  </nav>

  <main class="content">
    <!-- Scenario section (top text block) -->
    <section id="scenario" class="section">
      <h1>Scenario</h1>
    
      <!-- new wrapper -->
      <div class="scenario-card" role="region" aria-labelledby="scenario-heading" tabindex="0">
        <p class="scenario-lead">
          It's a stinky evening at the Naghmi manor. A scream breaks the night, and now
          everyone is a suspect. Read below and meet the guests.
        </p>
    
        <!-- optional extra text that is hidden until expand -->
        <p class="scenario-more" aria-hidden="true">
          Some optional / additional text here
        </p>
    
        <button type="button" class="scenario-toggle" aria-expanded="false">Read more</button>
      </div>
    </section>

    <!-- Attendees (gallery) -->
    <section id="attendees" class="section">
      <h2>Attendees</h2>
      <div class="gallery">
        <!-- Repeat one line per attendee image -->
        <figure class="attendee" tabindex="0" data-name="Zain, the host">
          <img src="images/attendee1.png" alt="Zain, the host" loading="lazy">
          <figcaption>Zain, the host</figcaption>
          <span class="overlay" aria-hidden="true">Host • Suspect</span>
        </figure>

        <figure class="attendee" tabindex="0" data-name="Mario, the ">
          <img src="images/attendee2.png" alt="Mario, the " loading="lazy">
          <figcaption>Mario, the ?</figcaption>
          <span class="overlay" aria-hidden="true">Guest • Suspect</span>
        </figure>

        <!-- more attendee <figure> blocks for each photo -->
      </div>
    </section>
  </main>

  <footer class="site-footer">
    © Kevin Hoang
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const card = document.querySelector('.scenario-card');
      if (!card) return;
    
      const btn = card.querySelector('.scenario-toggle');
      const more = card.querySelector('.scenario-more');
    
      // Defensive: if elements missing, bail gracefully
      if (!btn || !more) {
        console.warn('Scenario toggle or more content not found.');
        return;
      }
    
      // Ensure collapsed initial state
      more.style.maxHeight = more.classList.contains('expanded') ? `${more.scrollHeight}px` : '0px';
      more.setAttribute('aria-hidden', more.style.maxHeight === '0px' ? 'true' : 'false');
    
      function setExpanded(expanded) {
        btn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        if (expanded) {
          // set to exact scrollHeight so transition animates correctly
          more.style.maxHeight = `${more.scrollHeight}px`;
          more.setAttribute('aria-hidden', 'false');
          card.classList.add('expanded');
        } else {
          // collapse
          more.style.maxHeight = '0px';
          more.setAttribute('aria-hidden', 'true');
          card.classList.remove('expanded');
        }
      }
    
      // click handler
      btn.addEventListener('click', () => {
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        setExpanded(!isExpanded);
      });
    
      // keyboard toggle on Enter/Space when card focused
      card.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          btn.click();
        }
      });
    
      // Optional: when the panel finishes expanding, clear inline maxHeight to allow responsive wrapping
      more.addEventListener('transitionend', (ev) => {
        if (ev.propertyName === 'max-height' && btn.getAttribute('aria-expanded') === 'true') {
          // allow it to size naturally after animation
          more.style.maxHeight = 'none';
        }
      });
    
    });
    </script>
    
</body>
</html>
